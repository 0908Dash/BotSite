<html lang="en">
  <head>
    <!-- Meta tags -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Title and Stylesheet -->
    <title>CSBot Panel</title>
    <link rel="stylesheet" href="panel.css">
  </head>
  <body>
    <!-- Heading -->
    <h1>CSBot's Panel</h1>
    <!-- Main Container -->
    <div class="components">
      <!-- Dark Mode Toggle -->
      <label class="switch">
        <input type="checkbox" id="dark-mode-toggle">
        <span class="slider round"></span>
      </label>

      <!-- Button Container -->
      <div class="button-container">
        <!-- Buttons -->
        <button id="start-btn" class="rounded-btn">START</button>
        <button id="deploy-btn" class="rounded-btn">DEPLOY-COMMANDS</button>
        <button id="delete-btn" class="rounded-btn">DELETE-COMMANDS</button>
      </div>

      <!-- Console Container -->
      <div class="console-container">
        <!-- Console Textarea -->
        <textarea id="console" rows="10" cols="50" readonly></textarea>
        <!-- Console Form -->
        <form id="console-form">
          <!-- Console Input -->
          <input type="text" id="console-input" placeholder="Input Here" autocomplete="on">
          <!-- Console Submit Button -->
          <button type="submit" id="console-submit-btn" class="rounded-btn">SEND</button>
        </form>
      </div>
    </div>
  </body>
  <script>
    //-------------------------- Override Console Log Function
    const consoleTextarea = document.getElementById('console');

    console.log = function (message) {
      window.originalConsoleLog(message);
      consoleTextarea.value += `${message}\n`;
    };

    window.originalConsoleLog = console.log;

    //-------------------------- Dark Mode Toggle
    const toggleSwitch = document.querySelector('#dark-mode-toggle');

    function switchTheme(event) {
      if (event.target.checked) {
        document.documentElement.setAttribute('data-theme', 'dark');
        localStorage.setItem('theme', 'dark');
      } else {
        document.documentElement.setAttribute('data-theme', 'light');
        localStorage.setItem('theme', 'light');
      }
    }

    toggleSwitch.addEventListener('change', switchTheme, false);

    const currentTheme = localStorage.getItem('theme') || 'light';

    if (currentTheme) {
      document.documentElement.setAttribute('data-theme', currentTheme);

      if (currentTheme === 'dark') {
        toggleSwitch.checked = true;
      }
    }

    //-------------------------- Button Actions
    const startBtn = document.getElementById('start-btn');
    const deployBtn = document.getElementById('deploy-btn');
    const deleteBtn = document.getElementById('delete-btn');

    startBtn.addEventListener('click', () => {
      makeRequest('https://4x7xb1xb-1119.use2.devtunnels.ms/start-bot');
    });

    deployBtn.addEventListener('click', () => {
      makeRequest('https://4x7xb1xb-1119.use2.devtunnels.ms/deploy-commands');
    });

    deleteBtn.addEventListener('click', () => {
      makeRequest('https://4x7xb1xb-1119.use2.devtunnels.ms/delete-commands');
    });

    function makeRequest(endpoint) {
      fetch(endpoint)
        .then(response => response.json())
        .then(data => {
          console.log(`Action completed: ${data.status}`);
        })
        .catch(error => {
          console.error(`Error executing action: ${error}`);
        });
    }

    //-------------------------- Health Check
    function performHealthCheck() {
      fetch('https://4x7xb1xb-1119.use2.devtunnels.ms/')
        .then(response => {
          if (response.ok) {
            console.log('Server is reachable');
          } else {
            console.error('Server is not reachable');
            displayMessage('Connection lost. Please check your internet connection.');
          }
        })
        .catch(error => {
          console.error('Error during health check:', error);
          displayMessage('Connection lost. Please check your internet connection.');
        });
    }

    function displayMessage(message) {
      console.log(message);
    }

    setInterval(performHealthCheck, 30000);
    setTimeout(performHealthCheck, 2000);

    setInterval(function () {
      displayMessage('Displaying a message every 30 minutes.');
    }, 1800000);
//-----------------------------------------Input Processing function
    const consoleInput = document.getElementById('console-input');
  const consoleSubmitBtn = document.getElementById('console-submit-btn');

  consoleSubmitBtn.addEventListener('click', function (event) {
    event.preventDefault(); // Prevent the default form submission behavior

    // Get the input value
    const userInput = consoleInput.value.trim();

    if (userInput !== '') {
      // Display the user input in the console
      console.log(`User Input: ${userInput}`);

      // Send the input to the server for processing
      processInputOnServer(userInput);

      // Clear the input field
      consoleInput.value = '';
    }
  });

  function processInputOnServer(input) {
    // Send an HTTP request to the server with the user input
    fetch('https://4x7xb1xb-1119.use2.devtunnels.ms/process-input', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        input: input,
      }),
    })
      .then(response => response.json())
      .then(data => {
        console.log(`Server Response: ${data.message}`);
      })
      .catch(error => {
        console.error('Error processing input on the server:', error);
      });
  }
//--------------------------------------------------------------
  </script>
</html>
